"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[9419],{16333:function(e,r,t){t.d(r,{Ld:function(){return n.L}});t(37750),t(44072);var n=t(38815)},30676:function(e,r,t){t.d(r,{z7:function(){return T},VE:function(){return N}});var n=t(76386),o=t(91215),i=t(49693),s=t(94066),a=t(3491),u=t(20515),c=t(27962),l=t(54921),d=t(94811),f=t(52394),p=t(76118),h=t(73408),v=(t(46709),t(16333)),m=t(74060),g=t(27757);var E={name:"1739oy8",styles:"z-index:1"};function y({tooltipMessage:e,...r}){const t=E;return(0,h.Y)(m.LegacyTooltip,{title:e,children:(0,h.Y)(g.B,{componentId:"codegen_web-shared_src_snippet_actions_snippetactionbutton.tsx_33",...r,css:t})})}function N({copyText:e,onClick:r,...t}){const{actionIcon:n,tooltipMessage:o,copy:i}=(0,v.Ld)(e);return(0,h.Y)(y,{tooltipMessage:o,icon:n,onClick:e=>{i(),null===r||void 0===r||r(e)},...t})}n.A.registerLanguage("sql",l.A),n.A.registerLanguage("java",i.A),n.A.registerLanguage("python",u.A),n.A.registerLanguage("go",o.A),n.A.registerLanguage("javascript",s.A),n.A.registerLanguage("yaml",c.A),n.A.registerLanguage("json",a.A);const w="24px",A={light:f.A,duotoneDark:d.A};function T({theme:e="light",language:r,actions:t,style:o,children:i,showLineNumbers:s,lineNumberStyle:a,wrapLongLines:u,wrapLines:c,PreTag:l}){const d={border:"none",borderRadius:0,margin:0,padding:w,...o};return(0,h.Y)(n.A,{showLineNumbers:s,lineNumberStyle:a,language:r,style:A[e],customStyle:d,codeTagProps:{style:(0,p.pick)(o,"backgroundColor")},wrapLongLines:u,wrapLines:c,PreTag:l,children:i})}},36476:function(e,r,t){t.d(r,{a$:function(){return u}});var n=t(40724);let o=function(e){return e.UserInputError="UserInputError",e.UnexpectedSystemStateError="UnexpectedSystemStateError",e.ServerError="ServerError",e.SessionError="SessionError",e.NetworkError="NetworkError",e.ApplicationError="ApplicationError",e.UnknownError="UnknownError",e}({}),i=function(e){return e.BadRequestError="BadRequestError",e.DatasetRunNotFoundError="DatasetRunNotFoundError",e.FormValidationError="FormInputError",e.GenericNetworkRequestError="GenericNetworkRequestError",e.GraphQLGenericError="GraphQLGenericError",e.InternalServerError="InternalServerError",e.NotFoundError="NotFoundError",e.PermissionError="PermissionError",e.RateLimitedError="RateLimitedError",e.RouteNotFoundError="RouteNotFoundError",e.ServiceUnavailableError="ServiceUnavailableError",e.UnauthorizedError="UnauthorizedError",e.UnknownError="UnknownError",e}({});var s=t(73408);class a extends Error{constructor(e,r){super(e),this.errorLogType=void 0,this.errorName=void 0,this.displayMessage=void 0,this.isUserError=!1}}const u=e=>e instanceof a?e:e instanceof Error&&("networkError"in e||"graphQLErrors"in e)?c(e):e instanceof Response?l(e):new w(e);const c=e=>{return"networkError"in e&&((r=e.networkError)instanceof Error&&r.hasOwnProperty("response"))?l(e.networkError.response,e.networkError):new p(e);var r},l=(e,r)=>{const t=d.getNetworkRequestErrorDetailsFromResponse(e);switch(e.status){case 400:return new h(t,r);case 401:return new N(t,r);case 403:return new g(t,r);case 404:return new m(t,r);case 429:return new E(t,r);case 500:return new v(t,r);case 503:return new y(t,r);default:return new f(t,r)}};class d extends a{constructor(e,r,t){super(e,t),this.status=void 0,this.response=void 0,this.status=r.status,this.response=r.response}}d.getNetworkRequestErrorDetailsFromResponse=e=>({status:e.status});class f extends d{constructor(e,r){super("A network error occurred.",e,r),this.errorLogType=o.ServerError,this.errorName=i.GenericNetworkRequestError,this.displayMessage=(0,s.Y)(n.A,{id:"/CaNq/",defaultMessage:"A network error occurred."})}}class p extends a{constructor(e){super("A GraphQL error occurred.",e),this.errorLogType=o.ApplicationError,this.errorName=i.GraphQLGenericError,this.displayMessage=(0,s.Y)(n.A,{id:"PPPbd+",defaultMessage:"A GraphQL error occurred."})}}class h extends d{constructor(e,r){super("The request was invalid.",e,r),this.errorLogType=o.UserInputError,this.errorName=i.BadRequestError,this.displayMessage=(0,s.Y)(n.A,{id:"Id2mFI",defaultMessage:"The request was invalid."})}}class v extends d{constructor(e,r){super("Internal server error",e,r),this.errorLogType=o.ServerError,this.errorName=i.InternalServerError,this.displayMessage=(0,s.Y)(n.A,{id:"nY1YrF",defaultMessage:"Internal server error"})}}class m extends d{constructor(e,r){super("The requested resource was not found.",e,r),this.errorLogType=o.UserInputError,this.errorName=i.NotFoundError,this.displayMessage=(0,s.Y)(n.A,{id:"R3Lb6z",defaultMessage:"The requested resource was not found."}),this.isUserError=!0}}class g extends d{constructor(e,r){super("You do not have permission to access this resource.",e,r),this.errorLogType=o.UnexpectedSystemStateError,this.errorName=i.PermissionError,this.displayMessage=(0,s.Y)(n.A,{id:"G6IQTa",defaultMessage:"You do not have permission to access this resource."}),this.isUserError=!0}}class E extends d{constructor(e,r){super("This request exceeds the maximum queries per second limit. Please wait and try again.",e,r),this.errorLogType=o.ServerError,this.errorName=i.RateLimitedError,this.displayMessage=(0,s.Y)(n.A,{id:"5PlfiT",defaultMessage:"This request exceeds the maximum queries per second limit. Please wait and try again."})}}class y extends d{constructor(e,r){super("Internal server error",e,r),this.errorLogType=o.ServerError,this.errorName=i.InternalServerError,this.displayMessage=(0,s.Y)(n.A,{id:"/XlqZA",defaultMessage:"Service unavailable error"})}}class N extends d{constructor(e,r){super("This request exceeds the maximum queries per second limit. Please wait and try again.",e,r),this.errorLogType=o.SessionError,this.errorName=i.UnauthorizedError,this.displayMessage=(0,s.Y)(n.A,{id:"gqfk5C",defaultMessage:"User is not authorized."})}}class w extends a{constructor(e){super("An unknown error occurred.",e),this.errorLogType=o.UnknownError,this.errorName=i.UnknownError,this.displayMessage=(0,s.Y)(n.A,{id:"bKSd3c",defaultMessage:"An unknown error occurred."})}}},44072:function(e,r,t){t(46709),t(38815)},53637:function(e,r,t){t(46709)},72150:function(e,r,t){t.r(r),t.d(r,{AssessmentSchemaContextProvider:function(){return E.I},CodeSnippetRenderMode:function(){return y.cC},ExpectationValuePreview:function(){return o.S},INFERENCE_TABLE_RESPONSE_COLUMN_KEY:function(){return y.O5},INFERENCE_TABLE_TRACE_COLUMN_KEY:function(){return y.So},MLFLOW_TRACE_SCHEMA_VERSION_KEY:function(){return y.jQ},ModelIconType:function(){return y.Dy},ModelSpanType:function(){return y.UG},ModelTraceExplorer:function(){return n.a},ModelTraceExplorerOSSNotebookRenderer:function(){return v},ModelTraceExplorerSkeleton:function(){return i.F},ModelTraceSpanType:function(){return y.VZ},getAssessmentValue:function(){return g.e},getModelTraceId:function(){return m.MF},getModelTraceSpanEndTime:function(){return m.jE},getModelTraceSpanId:function(){return m.wH},getModelTraceSpanParentId:function(){return m.cp},getModelTraceSpanStartTime:function(){return m.CR},getTraceArtifact:function(){return N.g},isModelTrace:function(){return m.Lq},isV3ModelTraceInfo:function(){return m.gD},isV3ModelTraceSpan:function(){return m.UZ},tryDeserializeAttribute:function(){return m.xD}});var n=t(5169),o=t(777),i=t(15929),s=t(68248),a=t(46709),u=t(27757),c=t(74060),l=t(42747),d=t(73408);const f=(e,r)=>{const t=new URLSearchParams;return t.append("selectedTraceId",e),t.append("compareRunsMode","TRACES"),`/#/experiments/${r}?${t.toString()}`};var p={name:"1elrbzk",styles:"width:calc(100% - 2px)"},h={name:"inxa61",styles:"flex:1;overflow:hidden"};const v=()=>{const e=(0,a.useMemo)((()=>new URLSearchParams(window.location.search).getAll("trace_id")),[]),r=(0,a.useMemo)((()=>new URLSearchParams(window.location.search).getAll("experiment_id")),[]),[t,o]=(0,a.useState)(e.length>0?0:null),[i,v]=(0,a.useState)(null),[m,g]=(0,a.useState)(!0),[E,y]=(0,a.useState)(null),{theme:w}=(0,u.u)();return(0,a.useEffect)((()=>{(async()=>{if(null===t)return;g(!0);const r=e[t],n=await(0,N.g)(r);"string"===typeof n?y(n):v(n),g(!1)})()}),[t,e]),0===e.length||null===t?null:m?(0,d.Y)("div",{css:p,children:(0,d.Y)(u.T.Text,{color:"secondary",children:(0,d.Y)(l.sA,{id:"JJFZ1V",defaultMessage:"Fetching trace data..."})})}):i?(0,d.FD)("div",{css:(0,s.AH)({display:"flex",flexDirection:"column",border:`1px solid ${w.colors.border}`,height:"calc(100% - 2px)"},""),children:[(0,d.FD)("div",{css:(0,s.AH)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:`${w.spacing.xs}px ${w.spacing.md}px`},""),children:[(0,d.FD)("div",{css:(0,s.AH)({display:"flex",alignItems:"center",gap:w.spacing.sm},""),children:[(0,d.Y)(u.T.Title,{level:4,withoutMargins:!0,children:"MLflow Trace UI"}),(0,d.Y)(c.InfoTooltip,{componentId:"mlflow.notebook.trace-ui-info",iconTitle:"More information",maxWidth:400,content:(0,d.Y)(l.sA,{id:"LED2z5",defaultMessage:"To disable or enable this display, call {disableFunction} or {enableFunction} and re-run the cell",values:{disableFunction:(0,d.Y)("code",{children:"mlflow.tracing.disable_notebook_display()"}),enableFunction:(0,d.Y)("code",{children:"mlflow.tracing.enable_notebook_display()"})}})}),(0,d.Y)(u.T.Link,{componentId:"mlflow.notebook.trace-ui-learn-more-link",href:"https://mlflow.org/docs/latest/llms/tracing/index.html?ref=jupyter-notebook-widget",openInNewTab:!0,title:"Learn More",children:(0,d.Y)(l.sA,{id:"uIY1qq",defaultMessage:"Learn More"})})]}),(0,d.Y)(u.T.Link,{componentId:"mlflow.notebook.trace-ui-see-in-mlflow-link",href:f(e[t],r[t]),openInNewTab:!0,title:"View in MLflow UI",children:(0,d.Y)(l.sA,{id:"4NyhOm",defaultMessage:"View in MLflow UI"})})]}),e.length>1&&(0,d.Y)(c.Pagination,{componentId:"mlflow.notebook.pagination",currentPageIndex:t+1,dangerouslySetAntdProps:{showQuickJumper:!0},numTotal:e.length,onChange:e=>o(e-1),pageSize:1,style:{marginBottom:w.spacing.sm,paddingLeft:w.spacing.sm,paddingRight:w.spacing.sm}}),(0,d.Y)("div",{css:h,children:(0,d.Y)(n.a,{modelTrace:i,initialActiveView:"detail"})})]}):(0,d.Y)("div",{css:(0,s.AH)({paddingTop:w.spacing.md,width:"calc(100% - 2px)"},""),children:(0,d.Y)(c.Empty,{image:(0,d.Y)(u.k,{}),description:(0,d.FD)(d.FK,{children:[(0,d.Y)(u.T.Paragraph,{children:(0,d.Y)(l.sA,{id:"UD4Z+e",defaultMessage:"An error occurred while attempting to fetch trace data (ID: {traceId}). Please ensure that the MLflow tracking server is running, and that the trace data exists. Error details:",values:{traceId:e[t]}})}),E&&(0,d.Y)(u.T.Paragraph,{children:E})]}),title:(0,d.Y)(l.sA,{id:"md81Lo",defaultMessage:"Error"})})})};var m=t(86125),g=t(33145),E=t(57248),y=t(94664),N=t(97311)},86125:function(e,r,t){t.d(r,{BS:function(){return c},CL:function(){return W},CR:function(){return T},Hq:function(){return B},I$:function(){return K},LS:function(){return f},Lq:function(){return I},MF:function(){return R},N7:function(){return G},OS:function(){return x},PC:function(){return P},Q0:function(){return D},UZ:function(){return N},W0:function(){return O},ZI:function(){return $},bn:function(){return Y},cp:function(){return A},f7:function(){return m},gD:function(){return y},g_:function(){return U},h8:function(){return q},ij:function(){return l},in:function(){return V},jE:function(){return M},jW:function(){return L},ob:function(){return S},pQ:function(){return z},tC:function(){return d},vL:function(){return v},vl:function(){return C},wH:function(){return w},x0:function(){return j},xD:function(){return p}});var n=t(68248),o=t(76118),i=t(94664),s=t(51847),a=t(27786),u=t(73408);const c="model-trace-info-v3",l=e=>{};function d(e){switch(e){case i.UG.LLM:return i.Dy.MODELS;case i.UG.CHAIN:return i.Dy.CHAIN;case i.UG.AGENT:return i.Dy.AGENT;case i.UG.TOOL:return i.Dy.WRENCH;case i.UG.CHAT_MODEL:return i.Dy.MODELS;case i.UG.RETRIEVER:return i.Dy.SEARCH;case i.UG.PARSER:return i.Dy.CODE;case i.UG.EMBEDDING:return i.Dy.NUMBERS;case i.UG.RERANKER:return i.Dy.SORT;case i.UG.MEMORY:return i.Dy.SAVE;case i.UG.FUNCTION:return i.Dy.FUNCTION;case i.UG.UNKNOWN:return i.Dy.UNKNOWN;default:return i.Dy.FUNCTION}}function f(e){switch(e){case i.UG.LLM:return"LLM";case i.UG.CHAIN:return"Chain";case i.UG.AGENT:return"Agent";case i.UG.TOOL:return"Tool";case i.UG.CHAT_MODEL:return"Chat model";case i.UG.RETRIEVER:return"Retriever";case i.UG.PARSER:return"Parser";case i.UG.EMBEDDING:return"Embedding";case i.UG.RERANKER:return"Reranker";case i.UG.MEMORY:return"Memory";case i.UG.FUNCTION:return"Function";case i.UG.UNKNOWN:return"Unknown";default:return e}}function p(e){try{return JSON.parse(e)}catch(r){return e}}const h=(e,r)=>{if(!r)return[];const t=[],n={inputs:null===e||void 0===e?void 0:e.inputs,outputs:null===e||void 0===e?void 0:e.outputs,attributes:null===e||void 0===e?void 0:e.attributes,events:null===e||void 0===e?void 0:e.events};return(0,o.map)(n,((n,o)=>{if("events"===o)return void t.push(...((e,r)=>{const t=e.events;if(!t)return[];const n=[];return t.forEach(((t,o)=>{const i=t.attributes;i&&Object.keys(i).forEach((s=>{const a=s.toLowerCase().includes(r),u=D(t.name,o,s);a&&n.push({span:e,section:"events",key:u,isKeyMatch:!0,matchIndex:0});const c=JSON.stringify(i[s]).toLowerCase().split(r).length-1;for(let r=0;r<c;r++)n.push({span:e,section:"events",key:u,isKeyMatch:!1,matchIndex:r})}))})),n})(e,r));U(n).forEach((n=>{n.key.toLowerCase().includes(r)&&t.push({span:e,section:o,key:n.key,isKeyMatch:!0,matchIndex:0});const i=n.value.toLowerCase().split(r).length-1;for(let r=0;r<i;r++)t.push({span:e,section:o,key:n.key,isKeyMatch:!1,matchIndex:r})}))})),t};function v(e,r,t){var n,o;const i=r.toLowerCase().trim(),s=Object.values(t.spanTypeDisplayState).every((e=>e));if(""===i&&s)return{filteredTreeNodes:[e],matches:[]};const a=null!==(n=e.children)&&void 0!==n?n:[],u=[],c=[];a.forEach((e=>{const{filteredTreeNodes:r,matches:n}=v(e,i,t);u.push(...r),c.push(...n)}));const l=(null!==(o=e.title)&&void 0!==o?o:"").toLowerCase(),d=h(e,i),f=d.length>0||l.includes(i),p=!e.type||t.spanTypeDisplayState[e.type],m=f&&p,g=u.length>0,E=G(e)>0;return m||t.showParents&&g||t.showExceptions&&E?{filteredTreeNodes:[{...e,children:u}],matches:d.concat(c)}:{filteredTreeNodes:u,matches:c}}function m(e,r){var t;if((0,o.isNil)(r)||(0,o.isNil)(e))return;if(e.key===r)return e;const n=null!==(t=e.children)&&void 0!==t?t:[];for(const o of n){const e=m(o,r);if(e)return e}}const g=(e,r,t,n,i,a)=>{var c,l,f,h,v,m,g,E;const y=p(null===(c=e.attributes)||void 0===c?void 0:c["mlflow.spanType"]),N=p(null===(l=e.attributes)||void 0===l?void 0:l["mlflow.spanInputs"]),R=p(null===(f=e.attributes)||void 0===f?void 0:f["mlflow.spanOutputs"]),S=A(e),L=w(e),b=null!==(h=i[L])&&void 0!==h?h:[];var _;S||b.push(...null!==(_=i[""])&&void 0!==_?_:[]);const k=((e,r,t,n)=>{var i,s;if(Array.isArray(e)&&e.every(K))return(0,o.compact)(e.map($));const a=null!==(i=B(r,n))&&void 0!==i?i:[],u=null!==(s=B(t,n))&&void 0!==s?s:[];return 0!==a.length&&0!==u.length?a.concat(u):void 0})(p(null===(v=e.attributes)||void 0===v?void 0:v["mlflow.chat.messages"]),N,R,p(null===(m=e.attributes)||void 0===m?void 0:m["mlflow.message.format"])),I=((e,r)=>{var t;return Array.isArray(e)&&e.every(P)?e:Array.isArray(null===r||void 0===r?void 0:r.tools)&&null!==r&&void 0!==r&&null!==(t=r.tools)&&void 0!==t&&t.every(P)?r.tools:void 0})(p(null===(g=e.attributes)||void 0===g?void 0:g["mlflow.chat.tools"]),N),U=(0,o.mapValues)((0,o.omitBy)(e.attributes,((e,r)=>r.startsWith("mlflow."))),(e=>p(e))),x=e.events,O=(Number(T(e))-r)/1e3,C=(Number(null!==(E=M(e))&&void 0!==E?E:t)-r)/1e3;return{title:e.name,icon:(0,u.Y)(s.P,{type:d(y),hasException:G(e)>0,isRootSpan:!S}),type:y,key:L,start:O,end:C,children:n,inputs:N,outputs:R,attributes:U,events:x,chatMessages:k,chatTools:I,parentId:S,assessments:b,traceId:a}},E=(e,r)=>{if(!e)return"";if(r)try{return(e=>{const r=atob(e),t=r.length;let n="";for(let o=0;o<t;o++)n+=r.charCodeAt(o).toString(16).padStart(2,"0");return n})(e)}catch(t){return e}return e.startsWith("0x")?e.slice(2):e};function y(e){return"trace_metadata"in e}function N(e){return"start_time_unix_nano"in e}function w(e){var r,t,n;return N(e)?E(null!==(r=e.span_id)&&void 0!==r?r:"",!0):E(null!==(t=null===(n=e.context)||void 0===n?void 0:n.span_id)&&void 0!==t?t:"",!1)}function A(e){var r,t;return N(e)?E(null!==(r=e.parent_span_id)&&void 0!==r?r:"",!0):E(null!==(t=e.parent_id)&&void 0!==t?t:"",!1)}function T(e){return N(e)?Number(e.start_time_unix_nano):Number(e.start_time)}function M(e){return N(e)?Number(e.end_time_unix_nano):Number(e.end_time)}function R(e){var r;return y(e.info)?e.info.trace_id:null!==(r=e.info.request_id)&&void 0!==r?r:""}function S(e){var r,t;if(!y(e.info))return null;const n=Number(null===(r=e.info)||void 0===r||null===(t=r.trace_metadata)||void 0===t?void 0:t["mlflow.trace.sizeBytes"]);return(0,o.isNil)(n)||isNaN(n)?null:n}function L(e){var r,t;const n=R(e),a=null!==(r=null===(t=e.trace_data)||void 0===t?void 0:t.spans)&&void 0!==r?r:e.data.spans,c={},l={};a.forEach((e=>{const r=w(e);c[r]=e,l[r]=[]})),a.forEach((e=>{const r=w(e),t=A(e);if(t){if(!l[t])throw new Error("Tree structure is malformed!");l[t].push(r)}}));const f=a.find((e=>!A(e)));if((0,o.isNil)(f))return null;return function r(t){var o,a,p;const h=c[t],v=Number(T(f)),m=Number(M(f)),E=l[t].map(r),y=b(e.info);if(N(h)||"parent_id"in h)return g(h,v,m,E,y,n);const w=null!==(o=h.span_type)&&void 0!==o?o:i.UG.UNKNOWN;return{title:h.name,icon:(0,u.Y)(s.P,{type:d(w)}),type:w,key:h.context.span_id,start:Number(h.start_time)-v,end:Number(null!==(a=h.end_time)&&void 0!==a?a:m)-v,children:E,inputs:h.inputs,outputs:h.outputs,attributes:h.attributes,events:h.events,parentId:null!==(p=h.parent_id)&&void 0!==p?p:h.parent_span_id,assessments:[],traceId:n}}(w(f))}const b=e=>{let r=[];var t;y(e)?r=null!==(t=e.assessments)&&void 0!==t?t:[]:r=_(e.tags);const n=(0,o.keyBy)(r,"assessment_id");Object.values(n).forEach((e=>{if(e.overrides){const r=n[e.overrides];e.overriddenAssessment=r}})),r=Object.values(n);const i=r.reduce(((e,r)=>{var t;const n=null!==(t=r.span_id)&&void 0!==t?t:"";return e[n]||(e[n]=[]),e[n].push(r),e}),{});return Object.keys(i).forEach((e=>{i[e].sort(((e,r)=>new Date(r.last_update_time).getTime()-new Date(e.last_update_time).getTime()))})),i},_=e=>{if(!e)return[];return(Array.isArray(e)?e:Object.entries(e).map((([e,r])=>({key:e,value:r})))).filter((({key:e})=>e.startsWith("mlflow.assessment."))).map((({value:e})=>JSON.parse(e)))};function k(e){var r;if(e)return(0,o.isArray)(e)?null===(r=e.find((e=>e.key===i.jQ)))||void 0===r?void 0:r.value:e[i.jQ]}const I=e=>{var r;const t=null===e||void 0===e?void 0:e.info,n=null===e||void 0===e?void 0:e.data;if(!t||!n||null===n||void 0===n||!n.spans)return!1;const o=null!==(r=null===t||void 0===t?void 0:t.request_metadata)&&void 0!==r?r:null===t||void 0===t?void 0:t.trace_metadata;if(o&&k(o))return!0;const i=null===t||void 0===t?void 0:t.tags;return!(!i||!k(i))},U=e=>(0,o.isNil)(e)?[]:Array.isArray(e)||(0,o.isString)(e)||(0,o.isNumber)(e)||(0,o.isBoolean)(e)?[{key:"",value:JSON.stringify(e,null,2)}]:Object.entries(e).map((([e,r])=>({key:e,value:JSON.stringify(r,null,2)}))),x=({searchFilter:e,data:r,activeMatchBackgroundColor:t,inactiveMatchBackgroundColor:i,containsActiveMatch:s,activeMatch:a,scrollToActiveMatch:c})=>{const l=new RegExp(`(${(0,o.escapeRegExp)(e.trim())})`,"gi"),d=r.split(l),f=[];let p=0;for(let o=0;o<d.length;o++)if(d[o].toLowerCase().includes(e.toLowerCase().trim())){const e=s&&a.matchIndex===p,r=e?t:i,l=(0,u.Y)("span",{ref:e?c:null,css:(0,n.AH)({backgroundColor:r,scrollMarginTop:50},""),children:d[o]},o);p++,f.push(l)}else f.push(d[o]);return f},O=e=>(0,o.has)(e,"page_content"),C=e=>e.type===i.UG.RETRIEVER&&Array.isArray(e.outputs)&&e.outputs.length>0&&(0,o.every)(e.outputs,O),D=(e,r,t)=>`${e}-${r}-${t}`,Y=e=>{var r;return(null!==(r=e.events)&&void 0!==r?r:[]).filter((e=>"exception"===e.name))},G=e=>Y(e).length,F=e=>!(0,o.isNil)(e)&&(!(!(0,o.isNil)(e.type)&&!(0,o.isString)(e.type))&&(!(!(0,o.isNil)(e.description)&&!(0,o.isString)(e.description))&&!(!(0,o.isNil)(e.enum)&&!Array.isArray(e.enum)))),P=e=>{var r;if((0,o.isNil)(e)||"function"!==e.type||!(0,o.has)(e,"function.name"))return!1;const t=null===(r=e.function)||void 0===r?void 0:r.parameters;if(!(0,o.isNil)(t)){const e=t.required;if(!(0,o.isNil)(e)&&(!Array.isArray(e)||!e.every(o.isString)))return!1;const r=t.properties;if(!(0,o.isNil)(r)&&!Object.values(r).every(F))return!1}return!0},q=e=>{var r,t;return e&&(0,o.isString)(e.id)&&(0,o.isString)(null===(r=e.function)||void 0===r?void 0:r.arguments)&&(0,o.isString)(null===(t=e.function)||void 0===t?void 0:t.name)},H=e=>!(!(0,o.isNil)(e)&&!(0,o.isString)(e))||!!(0,o.isArray)(e)&&e.every((e=>(e=>{switch(e.type){case"text":case"input_text":case"output_text":return(0,o.isString)(e.text);case"image_url":const{image_url:r}=e;return!(0,o.isNil)(r)&&(0,o.isString)(r.url)&&((0,o.isNil)(r.detail)||["auto","low","high"].includes(r.detail));case"input_audio":const{input_audio:t}=e;return!(0,o.isNil)(t)&&(0,o.isString)(t.data)&&((0,o.isNil)(t.format)||["wav","mp3"].includes(t.format));default:return!1}})(e))),K=e=>{if(!e)return!1;if(e.tool_calls){if(!Array.isArray(e.tool_calls))return!1;if(!e.tool_calls.every(q))return!1}return"reasoning"===e.type||!!H(e.content)&&("user"===e.role||"assistant"===e.role||"system"===e.role||"tool"===e.role)},j=e=>Array.isArray(e)&&e.length>0&&e.every((e=>{return(0,o.has)(e,"message")&&(r=e.message,!!K(r)&&((0,o.isNil)(r.content)||(0,o.isString)(r.content)));var r})),V=e=>e&&j(e.choices),B=(e,r)=>{var t,n,i,s,u,c,l,d,f,p,h,v;try{if(Array.isArray(e)&&e.length>0&&e.every(K))return(0,o.compact)(e.map($));switch(r){case"langchain":const r=null!==(t=(0,a.HD)(e))&&void 0!==t?t:(0,a.oI)(e);if(r)return r;break;case"llamaindex":const o=null!==(n=(0,a.Hy)(e))&&void 0!==n?n:(0,a.W3)(e);if(o)return o;break;case"openai":const m=null!==(i=null!==(s=null!==(u=(0,a.a8)(e))&&void 0!==u?u:(0,a.bS)(e))&&void 0!==s?s:(0,a.n_)(e))&&void 0!==i?i:(0,a.AG)(e);if(m)return m;break;case"dspy":const g=null!==(c=(0,a.iU)(e))&&void 0!==c?c:(0,a.Pn)(e);if(g)return g;break;case"gemini":const E=null!==(l=(0,a.DE)(e))&&void 0!==l?l:(0,a.Sy)(e);if(E)return E;break;case"anthropic":const y=null!==(d=(0,a.KF)(e))&&void 0!==d?d:(0,a.pL)(e);if(y)return y;break;case"openai-agent":const N=null!==(f=(0,a.xW)(e))&&void 0!==f?f:(0,a.m$)(e);if(N)return N;break;case"autogen":const w=null!==(p=(0,a.nW)(e))&&void 0!==p?p:(0,a.u6)(e);if(w)return w;break;case"bedrock":const A=null!==(h=(0,a.Yv)(e))&&void 0!==h?h:(0,a.f1)(e);if(A)return A;break;default:const T=null!==(v=(0,a.a8)(e))&&void 0!==v?v:(0,a.bS)(e);if(T)return T}return null}catch(m){return null}},W=e=>{var r;let t=null===(r=e.function)||void 0===r?void 0:r.arguments;try{t=JSON.stringify(JSON.parse(t),null,2)}catch(n){}return{id:e.id,function:{arguments:t,name:e.function.name}}},Q=e=>{if((0,o.isNil)(e)||(0,o.isString)(e))return e;return e.map((e=>{var r;switch(e.type){case"text":case"input_text":case"output_text":return e.text;case"image_url":const t=null===e||void 0===e||null===(r=e.image_url)||void 0===r?void 0:r.url;return t?`![](${t})`:"[image]";case"input_audio":return"[audio]"}})).filter((e=>void 0!==e)).join("\n\n")},$=e=>{var r;return"reasoning"===e.type?null:{...e,content:Q(e.content),tool_calls:null===(r=e.tool_calls)||void 0===r?void 0:r.map(W)}},z=e=>{if((0,o.isNil)(e))return"content";if(e.chatMessages)return"chat";return!(0,o.isNil)(e.inputs)||!(0,o.isNil)(e.outputs)?"content":"attributes"}},93846:function(e,r,t){t.d(r,{wY:function(){return o}});var n=t(46709);t(69103);function o({ref:e,debounceTimeMs:r}){const t=(0,n.useRef)({width:-1,height:-1}),o=(0,n.useRef)(),[i,s]=(0,n.useState)(null),a=(0,n.useCallback)((e=>{if(0===e.length)return;const n=e[0].contentRect;if(-1===t.current.width)return t.current={width:n.width,height:n.height},void s(t.current);if(n.width!==t.current.width||n.height!==t.current.height){if(t.current.width=n.width,t.current.height=n.height,!r)return void s({...t.current});clearTimeout(o.current),o.current=setTimeout((()=>{s({...t.current})}),r)}}),[r]),u=(0,n.useRef)();return u.current||(u.current=new ResizeObserver(a)),(0,n.useEffect)((()=>{const r="function"===typeof e?e():e.current;if(r){const e=u.current;return e.observe(r),()=>e.unobserve(r)}})),i}t(53637)},94664:function(e,r,t){t.d(r,{Dy:function(){return a},O5:function(){return o},So:function(){return i},UG:function(){return s},VZ:function(){return u},cC:function(){return c},jQ:function(){return n}});const n="mlflow.trace_schema.version",o="response",i="trace";let s=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.FUNCTION="FUNCTION",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.MEMORY="MEMORY",e.UNKNOWN="UNKNOWN",e}({}),a=function(e){return e.MODELS="models",e.DOCUMENT="document",e.CONNECT="connect",e.SEARCH="search",e.SORT="sort",e.UNKNOWN="unknown",e.FUNCTION="function",e.CODE="code",e.NUMBERS="numbers",e.WRENCH="wrench",e.AGENT="agent",e.CHAIN="chain",e.USER="user",e.SYSTEM="system",e.SAVE="save",e}({}),u=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.MEMORY="MEMORY",e.UNKNOWN="UNKNOWN",e}({}),c=function(e){return e.JSON="json",e.TEXT="text",e.MARKDOWN="markdown",e.PYTHON="python",e}({})},97311:function(e,r,t){async function n(e){try{const r=await fetch(`/ajax-api/2.0/mlflow/get-trace-artifact?request_id=${e}`),t=await r.text(),n=JSON.parse(t);return n.spans?{info:{request_id:e},data:n}:n.error_code?n.message:"Unknown error occurred"}catch(r){return r instanceof Error?r.message:"string"===typeof r?r:"Unknown error occurred"}}t.d(r,{g:function(){return n}})}}]);