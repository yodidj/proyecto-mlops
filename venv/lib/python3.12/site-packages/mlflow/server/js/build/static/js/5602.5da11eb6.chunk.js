"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[5602],{27042:function(e,t,n){n.d(t,{Q:function(){return M}});var r=n(68248),a=n(76118),s=n(46709),o=n(27757),i=n(79081),l=n(74060),u=n(7655),c=n(40724),d=n(884),f=n(73408);var m={name:"4zleql",styles:"display:block"};function p(e){return t=>function(e,t){const n=(0,u.A)(),{theme:i}=(0,o.u)(),c=e.props.searchValue.toLowerCase();return(0,s.useMemo)((()=>{if(!c)return e;if((0,a.sortedIndexOf)(t,c)>=0)return e;const o=/^[^,.:/=\-\s]+$/.test(c);return s.cloneElement(e,{flattenOptions:[{data:{value:c,disabled:!o,style:{color:o?i.colors.actionTertiaryTextDefault:i.colors.actionDisabledText},children:(0,f.Y)(l.LegacyTooltip,{title:o?void 0:n.formatMessage({id:"fWEvZL",defaultMessage:", . : / - = and blank spaces are not allowed"}),placement:"right",children:(0,f.FD)("span",{css:m,children:[(0,f.Y)(l.PlusIcon,{css:(0,r.AH)({marginRight:i.spacing.sm},"")}),n.formatMessage({id:"IJbauF",defaultMessage:'Add tag "{tagKey}"'},{tagKey:c})]})})},key:c,groupOption:!1},...e.props.flattenOptions]})}),[t,e,c,n,i])}(t,e)}var v={name:"1d3w5wq",styles:"width:100%"};function g({allAvailableTags:e,control:t,onKeyChangeCallback:n}){const r=(0,u.A)(),[a,o]=(0,s.useState)(!1),i=(0,s.useRef)(null),{field:c,fieldState:m}=(0,d.as)({control:t,name:"key",rules:{required:{message:r.formatMessage({id:"RlBbjb",defaultMessage:"A tag key is required"}),value:!0}}});return(0,f.Y)(l.LegacySelect,{allowClear:!0,ref:i,dangerouslySetAntdProps:{showSearch:!0,dropdownRender:p(e)},css:v,placeholder:r.formatMessage({id:"8ALhnh",defaultMessage:"Type a key"}),value:c.value,defaultValue:c.value,open:a,onDropdownVisibleChange:e=>{o(e)},filterOption:(e,t)=>null===t||void 0===t?void 0:t.value.toLowerCase().includes(e.toLowerCase()),onSelect:e=>{c.onChange(e),null===n||void 0===n||n(e)},onClear:()=>{c.onChange(void 0),null===n||void 0===n||n(void 0)},validationState:m.error?"error":void 0,children:e.map((e=>(0,f.Y)(l.LegacySelect.Option,{value:e,children:e},e)))})}var h=n(59281),y=n(77153);function _(e){return new Map(e.map((e=>[e.key,e])))}var N={name:"82a6rk",styles:"flex:1"},E={name:"82a6rk",styles:"flex:1"};const M=({onSuccess:e,saveTagsHandler:t,allAvailableTags:n,valueRequired:m=!1,title:p})=>{const v=(0,s.useRef)(),[M,A]=(0,s.useState)(""),{theme:T}=(0,o.u)(),[k,b]=(0,s.useState)(new Map),[C,R]=(0,s.useState)(new Map),[O,S]=(0,s.useState)(!1),x=(0,d.mN)({defaultValues:{key:void 0,value:""}}),I=()=>S(!1),D=(0,s.useCallback)((e=>{v.current=e,b(_(e.tags||[])),R(_(e.tags||[])),x.reset(),S(!0)}),[x]),L=async()=>{v.current&&(A(""),V(!0),t(v.current,Array.from(k.values()),Array.from(C.values())).then((()=>{I(),null===e||void 0===e||e(),V(!1)})).catch((e=>{var t;V(!1),A(e instanceof y.s?null===(t=e.getUserVisibleError())||void 0===t?void 0:t.message:e.message)})))},U=(0,u.A)(),Y=x.watch(),[G,V]=(0,s.useState)(!1),F=(0,s.useMemo)((()=>!(0,a.isEqual)((0,a.sortBy)(Array.from(k.values()),"key"),(0,a.sortBy)(Array.from(C.values()),"key"))),[k,C]),H=Y.key||Y.value,K=F&&H;return{EditTagsModal:(0,f.FD)(i.d,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_135",destroyOnClose:!0,visible:O,title:null!==p&&void 0!==p?p:(0,f.Y)(c.A,{id:"TBX+Gs",defaultMessage:"Add/Edit tags"}),onCancel:I,footer:(0,f.FD)(o.x,{children:[(0,f.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_147",dangerouslyUseFocusPseudoClass:!0,onClick:I,css:(0,r.AH)({marginRight:F?0:T.spacing.sm},""),children:U.formatMessage({id:"2a/rR8",defaultMessage:"Cancel"})}),K?(0,f.Y)(w,{formValues:Y,isLoading:G,onSaveTask:L}):(0,f.Y)(l.LegacyTooltip,{title:F?void 0:U.formatMessage({id:"16onEc",defaultMessage:"Please add or remove one or more tags before saving"}),children:(0,f.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_174",dangerouslyUseFocusPseudoClass:!0,disabled:!F,loading:G,type:"primary",onClick:L,children:U.formatMessage({id:"801Xh4",defaultMessage:"Save tags"})})})]}),children:[(0,f.FD)("form",{onSubmit:x.handleSubmit((()=>{if(m&&!Y.value.trim())return;const e=new Map(C);e.set(Y.key,Y),R(e),x.reset()})),css:(0,r.AH)({display:"flex",alignItems:"flex-end",gap:T.spacing.md},""),children:[(0,f.FD)("div",{css:(0,r.AH)({minWidth:0,display:"flex",gap:T.spacing.md,flex:1},""),children:[(0,f.FD)("div",{css:N,children:[(0,f.Y)(l.FormUI.Label,{htmlFor:"key",children:U.formatMessage({id:"crTWax",defaultMessage:"Key"})}),(0,f.Y)(g,{allAvailableTags:n||[],control:x.control,onKeyChangeCallback:e=>{var t;const n=e?C.get(e):void 0;x.setValue("value",null!==(t=null===n||void 0===n?void 0:n.value)&&void 0!==t?t:"")}})]}),(0,f.FD)("div",{css:E,children:[(0,f.Y)(l.FormUI.Label,{htmlFor:"value",children:m?U.formatMessage({id:"tHrp+A",defaultMessage:"Value"}):U.formatMessage({id:"4B8k46",defaultMessage:"Value (optional)"})}),(0,f.Y)(l.RHFControlledComponents.Input,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_223",name:"value",control:x.control,"aria-label":m?U.formatMessage({id:"tHrp+A",defaultMessage:"Value"}):U.formatMessage({id:"4B8k46",defaultMessage:"Value (optional)"}),placeholder:U.formatMessage({id:"FFe+Ug",defaultMessage:"Type a value"})})]})]}),(0,f.Y)(l.LegacyTooltip,{title:U.formatMessage({id:"tx3aAM",defaultMessage:"Add tag"}),children:(0,f.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_248",htmlType:"submit","aria-label":U.formatMessage({id:"tx3aAM",defaultMessage:"Add tag"}),children:(0,f.Y)(l.PlusIcon,{})})})]}),M&&(0,f.Y)(l.FormUI.Message,{type:"error",message:M}),(0,f.Y)("div",{css:(0,r.AH)({display:"flex",rowGap:T.spacing.xs,flexWrap:"wrap",marginTop:T.spacing.sm},""),children:Array.from(C.values()).map((e=>(0,f.Y)(h.t,{isClosable:!0,tag:e,onClose:()=>(({key:e})=>{R((t=>(t.delete(e),new Map(t))))})(e)},e.key)))})]}),showEditTagsModal:D,isLoading:G}};var A={name:"1y0ex1",styles:"max-width:400px"};function w({isLoading:e,formValues:t,onSaveTask:n}){const s=(0,u.A)(),{theme:i}=(0,o.u)(),l=`${`${(0,a.truncate)(t.key,{length:20})||"_"}`}${t.value?`:${(0,a.truncate)(t.value,{length:20})}`:""}`,c=s.formatMessage({id:"wcSVYI",defaultMessage:'Are you sure you want to save and close without adding "{tag}"'},{tag:l});return(0,f.FD)(o.aw.Root,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_309",children:[(0,f.Y)(o.aw.Trigger,{asChild:!0,children:(0,f.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_306",dangerouslyUseFocusPseudoClass:!0,loading:e,type:"primary",children:s.formatMessage({id:"801Xh4",defaultMessage:"Save tags"})})}),(0,f.FD)(o.aw.Content,{align:"end","aria-label":c,children:[(0,f.Y)(o.T.Paragraph,{css:A,children:c}),(0,f.Y)(o.aw.Close,{asChild:!0,children:(0,f.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_316",onClick:n,children:s.formatMessage({id:"mv6CY3",defaultMessage:"Yes, save and close"})})}),(0,f.Y)(o.aw.Close,{asChild:!0,children:(0,f.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_324",type:"primary",css:(0,r.AH)({marginLeft:i.spacing.sm},""),children:s.formatMessage({id:"geizp1",defaultMessage:"Cancel"})})}),(0,f.Y)(o.aw.Arrow,{})]})]})}},59281:function(e,t,n){n.d(t,{t:function(){return g}});var r=n(68248),a=n(74060),s=n(27757),o=n(46709),i=n(7655),l=n(79081),u=n(91701),c=n(73408);const{Paragraph:d}=s.T;var f={name:"zjik7",styles:"display:flex"},m={name:"1ff36h2",styles:"flex-grow:1"};const p=o.memo((e=>{const{theme:t}=(0,s.u)();return(0,c.Y)(l.d,{componentId:"codegen_mlflow_app_src_common_components_keyvaluetagfullviewmodal.tsx_17",title:"Tag: "+e.tagKey,visible:e.isKeyValueTagFullViewModalVisible,onCancel:()=>e.setIsKeyValueTagFullViewModalVisible(!1),children:(0,c.FD)("div",{css:f,children:[(0,c.Y)(d,{css:m,children:(0,c.Y)("pre",{css:(0,r.AH)({backgroundColor:t.colors.backgroundPrimary,marginTop:t.spacing.sm,whiteSpace:"pre-wrap",wordBreak:"break-all"},""),children:e.tagValue})}),(0,c.Y)("div",{css:(0,r.AH)({marginTop:t.spacing.sm},""),children:(0,c.Y)(u.i,{copyText:e.tagValue,showLabel:!1,icon:(0,c.Y)(a.CopyIcon,{}),"aria-label":"Copy"})})]})})}));function v(e=!0){return e?{overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap",whiteSpace:"nowrap"}:{whiteSpace:"nowrap"}}const g=({isClosable:e=!1,onClose:t,tag:n,enableFullViewModal:l=!1,charLimit:u=30,maxWidth:d=300,className:f})=>{const m=(0,i.A)(),[g,h]=(0,o.useState)(!1),{shouldTruncateKey:y,shouldTruncateValue:_}=function(e,t=30){const{key:n,value:r}=e,a=n.length+r.length,s=n.length>r.length,o=s?r.length:n.length;return a<=t?{shouldTruncateKey:!1,shouldTruncateValue:!1}:o>t/2?{shouldTruncateKey:!0,shouldTruncateValue:!0}:{shouldTruncateKey:s,shouldTruncateValue:!s}}(n,u),N=l&&(y||_),E=m.formatMessage({id:"ZXUtU8",defaultMessage:"Click to see more"});return(0,c.FD)("div",{children:[(0,c.Y)(a.Tag,{componentId:"codegen_mlflow_app_src_common_components_keyvaluetag.tsx_60",closable:e,onClose:t,title:n.key,className:f,children:(0,c.Y)(a.LegacyTooltip,{title:N?E:"",children:(0,c.FD)("span",{css:(0,r.AH)({maxWidth:d,display:"inline-flex"},""),onClick:()=>N?h(!0):void 0,children:[(0,c.Y)(s.T.Text,{bold:!0,title:n.key,css:v(y),children:n.key}),n.value&&(0,c.FD)(s.T.Text,{title:n.value,css:v(_),children:[": ",n.value]})]})})}),(0,c.Y)("div",{children:g&&(0,c.Y)(p,{tagKey:n.key,tagValue:n.value,isKeyValueTagFullViewModalVisible:g,setIsKeyValueTagFullViewModalVisible:h})})]})}},86125:function(e,t,n){n.d(t,{BS:function(){return u},CL:function(){return P},Hq:function(){return W},I$:function(){return H},LS:function(){return f},MF:function(){return T},N7:function(){return U},OS:function(){return S},PC:function(){return G},Q0:function(){return D},UZ:function(){return N},W0:function(){return x},ZI:function(){return $},bn:function(){return L},cp:function(){return M},f7:function(){return g},gD:function(){return _},g_:function(){return O},h8:function(){return V},ij:function(){return c},in:function(){return B},jW:function(){return b},ob:function(){return k},pQ:function(){return q},tC:function(){return d},vL:function(){return v},vl:function(){return I},x0:function(){return K},xD:function(){return m}});var r=n(68248),a=n(76118),s=n(94664),o=n(51847),i=n(27786),l=n(73408);const u="model-trace-info-v3",c=e=>{};function d(e){switch(e){case s.UG.LLM:return s.Dy.MODELS;case s.UG.CHAIN:return s.Dy.CHAIN;case s.UG.AGENT:return s.Dy.AGENT;case s.UG.TOOL:return s.Dy.WRENCH;case s.UG.CHAT_MODEL:return s.Dy.MODELS;case s.UG.RETRIEVER:return s.Dy.SEARCH;case s.UG.PARSER:return s.Dy.CODE;case s.UG.EMBEDDING:return s.Dy.NUMBERS;case s.UG.RERANKER:return s.Dy.SORT;case s.UG.MEMORY:return s.Dy.SAVE;case s.UG.FUNCTION:return s.Dy.FUNCTION;case s.UG.UNKNOWN:return s.Dy.UNKNOWN;default:return s.Dy.FUNCTION}}function f(e){switch(e){case s.UG.LLM:return"LLM";case s.UG.CHAIN:return"Chain";case s.UG.AGENT:return"Agent";case s.UG.TOOL:return"Tool";case s.UG.CHAT_MODEL:return"Chat model";case s.UG.RETRIEVER:return"Retriever";case s.UG.PARSER:return"Parser";case s.UG.EMBEDDING:return"Embedding";case s.UG.RERANKER:return"Reranker";case s.UG.MEMORY:return"Memory";case s.UG.FUNCTION:return"Function";case s.UG.UNKNOWN:return"Unknown";default:return e}}function m(e){try{return JSON.parse(e)}catch(t){return e}}const p=(e,t)=>{if(!t)return[];const n=[],r={inputs:null===e||void 0===e?void 0:e.inputs,outputs:null===e||void 0===e?void 0:e.outputs,attributes:null===e||void 0===e?void 0:e.attributes,events:null===e||void 0===e?void 0:e.events};return(0,a.map)(r,((r,a)=>{if("events"===a)return void n.push(...((e,t)=>{const n=e.events;if(!n)return[];const r=[];return n.forEach(((n,a)=>{const s=n.attributes;s&&Object.keys(s).forEach((o=>{const i=o.toLowerCase().includes(t),l=D(n.name,a,o);i&&r.push({span:e,section:"events",key:l,isKeyMatch:!0,matchIndex:0});const u=JSON.stringify(s[o]).toLowerCase().split(t).length-1;for(let t=0;t<u;t++)r.push({span:e,section:"events",key:l,isKeyMatch:!1,matchIndex:t})}))})),r})(e,t));O(r).forEach((r=>{r.key.toLowerCase().includes(t)&&n.push({span:e,section:a,key:r.key,isKeyMatch:!0,matchIndex:0});const s=r.value.toLowerCase().split(t).length-1;for(let t=0;t<s;t++)n.push({span:e,section:a,key:r.key,isKeyMatch:!1,matchIndex:t})}))})),n};function v(e,t,n){var r,a;const s=t.toLowerCase().trim(),o=Object.values(n.spanTypeDisplayState).every((e=>e));if(""===s&&o)return{filteredTreeNodes:[e],matches:[]};const i=null!==(r=e.children)&&void 0!==r?r:[],l=[],u=[];i.forEach((e=>{const{filteredTreeNodes:t,matches:r}=v(e,s,n);l.push(...t),u.push(...r)}));const c=(null!==(a=e.title)&&void 0!==a?a:"").toLowerCase(),d=p(e,s),f=d.length>0||c.includes(s),m=!e.type||n.spanTypeDisplayState[e.type],g=f&&m,h=l.length>0,y=U(e)>0;return g||n.showParents&&h||n.showExceptions&&y?{filteredTreeNodes:[{...e,children:l}],matches:d.concat(u)}:{filteredTreeNodes:l,matches:u}}function g(e,t){var n;if((0,a.isNil)(t)||(0,a.isNil)(e))return;if(e.key===t)return e;const r=null!==(n=e.children)&&void 0!==n?n:[];for(const a of r){const e=g(a,t);if(e)return e}}const h=(e,t,n,r,s,i)=>{var u,c,f,p,v,g,h,y;const _=m(null===(u=e.attributes)||void 0===u?void 0:u["mlflow.spanType"]),N=m(null===(c=e.attributes)||void 0===c?void 0:c["mlflow.spanInputs"]),T=m(null===(f=e.attributes)||void 0===f?void 0:f["mlflow.spanOutputs"]),k=M(e),b=E(e),C=null!==(p=s[b])&&void 0!==p?p:[];var R;k||C.push(...null!==(R=s[""])&&void 0!==R?R:[]);const O=((e,t,n,r)=>{var s,o;if(Array.isArray(e)&&e.every(H))return(0,a.compact)(e.map($));const i=null!==(s=W(t,r))&&void 0!==s?s:[],l=null!==(o=W(n,r))&&void 0!==o?o:[];return 0!==i.length&&0!==l.length?i.concat(l):void 0})(m(null===(v=e.attributes)||void 0===v?void 0:v["mlflow.chat.messages"]),N,T,m(null===(g=e.attributes)||void 0===g?void 0:g["mlflow.message.format"])),S=((e,t)=>{var n;return Array.isArray(e)&&e.every(G)?e:Array.isArray(null===t||void 0===t?void 0:t.tools)&&null!==t&&void 0!==t&&null!==(n=t.tools)&&void 0!==n&&n.every(G)?t.tools:void 0})(m(null===(h=e.attributes)||void 0===h?void 0:h["mlflow.chat.tools"]),N),x=(0,a.mapValues)((0,a.omitBy)(e.attributes,((e,t)=>t.startsWith("mlflow."))),(e=>m(e))),I=e.events,D=(Number(A(e))-t)/1e3,L=(Number(null!==(y=w(e))&&void 0!==y?y:n)-t)/1e3;return{title:e.name,icon:(0,l.Y)(o.P,{type:d(_),hasException:U(e)>0,isRootSpan:!k}),type:_,key:b,start:D,end:L,children:r,inputs:N,outputs:T,attributes:x,events:I,chatMessages:O,chatTools:S,parentId:k,assessments:C,traceId:i}},y=(e,t)=>{if(!e)return"";if(t)try{return(e=>{const t=atob(e),n=t.length;let r="";for(let a=0;a<n;a++)r+=t.charCodeAt(a).toString(16).padStart(2,"0");return r})(e)}catch(n){return e}return e.startsWith("0x")?e.slice(2):e};function _(e){return"trace_metadata"in e}function N(e){return"start_time_unix_nano"in e}function E(e){var t,n,r;return N(e)?y(null!==(t=e.span_id)&&void 0!==t?t:"",!0):y(null!==(n=null===(r=e.context)||void 0===r?void 0:r.span_id)&&void 0!==n?n:"",!1)}function M(e){var t,n;return N(e)?y(null!==(t=e.parent_span_id)&&void 0!==t?t:"",!0):y(null!==(n=e.parent_id)&&void 0!==n?n:"",!1)}function A(e){return N(e)?Number(e.start_time_unix_nano):Number(e.start_time)}function w(e){return N(e)?Number(e.end_time_unix_nano):Number(e.end_time)}function T(e){var t;return _(e.info)?e.info.trace_id:null!==(t=e.info.request_id)&&void 0!==t?t:""}function k(e){var t,n;if(!_(e.info))return null;const r=Number(null===(t=e.info)||void 0===t||null===(n=t.trace_metadata)||void 0===n?void 0:n["mlflow.trace.sizeBytes"]);return(0,a.isNil)(r)||isNaN(r)?null:r}function b(e){var t,n;const r=T(e),i=null!==(t=null===(n=e.trace_data)||void 0===n?void 0:n.spans)&&void 0!==t?t:e.data.spans,u={},c={};i.forEach((e=>{const t=E(e);u[t]=e,c[t]=[]})),i.forEach((e=>{const t=E(e),n=M(e);if(n){if(!c[n])throw new Error("Tree structure is malformed!");c[n].push(t)}}));const f=i.find((e=>!M(e)));if((0,a.isNil)(f))return null;return function t(n){var a,i,m;const p=u[n],v=Number(A(f)),g=Number(w(f)),y=c[n].map(t),_=C(e.info);if(N(p)||"parent_id"in p)return h(p,v,g,y,_,r);const E=null!==(a=p.span_type)&&void 0!==a?a:s.UG.UNKNOWN;return{title:p.name,icon:(0,l.Y)(o.P,{type:d(E)}),type:E,key:p.context.span_id,start:Number(p.start_time)-v,end:Number(null!==(i=p.end_time)&&void 0!==i?i:g)-v,children:y,inputs:p.inputs,outputs:p.outputs,attributes:p.attributes,events:p.events,parentId:null!==(m=p.parent_id)&&void 0!==m?m:p.parent_span_id,assessments:[],traceId:r}}(E(f))}const C=e=>{let t=[];var n;_(e)?t=null!==(n=e.assessments)&&void 0!==n?n:[]:t=R(e.tags);const r=(0,a.keyBy)(t,"assessment_id");Object.values(r).forEach((e=>{if(e.overrides){const t=r[e.overrides];e.overriddenAssessment=t}})),t=Object.values(r);const s=t.reduce(((e,t)=>{var n;const r=null!==(n=t.span_id)&&void 0!==n?n:"";return e[r]||(e[r]=[]),e[r].push(t),e}),{});return Object.keys(s).forEach((e=>{s[e].sort(((e,t)=>new Date(t.last_update_time).getTime()-new Date(e.last_update_time).getTime()))})),s},R=e=>{if(!e)return[];return(Array.isArray(e)?e:Object.entries(e).map((([e,t])=>({key:e,value:t})))).filter((({key:e})=>e.startsWith("mlflow.assessment."))).map((({value:e})=>JSON.parse(e)))};const O=e=>(0,a.isNil)(e)?[]:Array.isArray(e)||(0,a.isString)(e)||(0,a.isNumber)(e)||(0,a.isBoolean)(e)?[{key:"",value:JSON.stringify(e,null,2)}]:Object.entries(e).map((([e,t])=>({key:e,value:JSON.stringify(t,null,2)}))),S=({searchFilter:e,data:t,activeMatchBackgroundColor:n,inactiveMatchBackgroundColor:s,containsActiveMatch:o,activeMatch:i,scrollToActiveMatch:u})=>{const c=new RegExp(`(${(0,a.escapeRegExp)(e.trim())})`,"gi"),d=t.split(c),f=[];let m=0;for(let a=0;a<d.length;a++)if(d[a].toLowerCase().includes(e.toLowerCase().trim())){const e=o&&i.matchIndex===m,t=e?n:s,c=(0,l.Y)("span",{ref:e?u:null,css:(0,r.AH)({backgroundColor:t,scrollMarginTop:50},""),children:d[a]},a);m++,f.push(c)}else f.push(d[a]);return f},x=e=>(0,a.has)(e,"page_content"),I=e=>e.type===s.UG.RETRIEVER&&Array.isArray(e.outputs)&&e.outputs.length>0&&(0,a.every)(e.outputs,x),D=(e,t,n)=>`${e}-${t}-${n}`,L=e=>{var t;return(null!==(t=e.events)&&void 0!==t?t:[]).filter((e=>"exception"===e.name))},U=e=>L(e).length,Y=e=>!(0,a.isNil)(e)&&(!(!(0,a.isNil)(e.type)&&!(0,a.isString)(e.type))&&(!(!(0,a.isNil)(e.description)&&!(0,a.isString)(e.description))&&!(!(0,a.isNil)(e.enum)&&!Array.isArray(e.enum)))),G=e=>{var t;if((0,a.isNil)(e)||"function"!==e.type||!(0,a.has)(e,"function.name"))return!1;const n=null===(t=e.function)||void 0===t?void 0:t.parameters;if(!(0,a.isNil)(n)){const e=n.required;if(!(0,a.isNil)(e)&&(!Array.isArray(e)||!e.every(a.isString)))return!1;const t=n.properties;if(!(0,a.isNil)(t)&&!Object.values(t).every(Y))return!1}return!0},V=e=>{var t,n;return e&&(0,a.isString)(e.id)&&(0,a.isString)(null===(t=e.function)||void 0===t?void 0:t.arguments)&&(0,a.isString)(null===(n=e.function)||void 0===n?void 0:n.name)},F=e=>!(!(0,a.isNil)(e)&&!(0,a.isString)(e))||!!(0,a.isArray)(e)&&e.every((e=>(e=>{switch(e.type){case"text":case"input_text":case"output_text":return(0,a.isString)(e.text);case"image_url":const{image_url:t}=e;return!(0,a.isNil)(t)&&(0,a.isString)(t.url)&&((0,a.isNil)(t.detail)||["auto","low","high"].includes(t.detail));case"input_audio":const{input_audio:n}=e;return!(0,a.isNil)(n)&&(0,a.isString)(n.data)&&((0,a.isNil)(n.format)||["wav","mp3"].includes(n.format));default:return!1}})(e))),H=e=>{if(!e)return!1;if(e.tool_calls){if(!Array.isArray(e.tool_calls))return!1;if(!e.tool_calls.every(V))return!1}return"reasoning"===e.type||!!F(e.content)&&("user"===e.role||"assistant"===e.role||"system"===e.role||"tool"===e.role)},K=e=>Array.isArray(e)&&e.length>0&&e.every((e=>{return(0,a.has)(e,"message")&&(t=e.message,!!H(t)&&((0,a.isNil)(t.content)||(0,a.isString)(t.content)));var t})),B=e=>e&&K(e.choices),W=(e,t)=>{var n,r,s,o,l,u,c,d,f,m,p,v;try{if(Array.isArray(e)&&e.length>0&&e.every(H))return(0,a.compact)(e.map($));switch(t){case"langchain":const t=null!==(n=(0,i.HD)(e))&&void 0!==n?n:(0,i.oI)(e);if(t)return t;break;case"llamaindex":const a=null!==(r=(0,i.Hy)(e))&&void 0!==r?r:(0,i.W3)(e);if(a)return a;break;case"openai":const g=null!==(s=null!==(o=null!==(l=(0,i.a8)(e))&&void 0!==l?l:(0,i.bS)(e))&&void 0!==o?o:(0,i.n_)(e))&&void 0!==s?s:(0,i.AG)(e);if(g)return g;break;case"dspy":const h=null!==(u=(0,i.iU)(e))&&void 0!==u?u:(0,i.Pn)(e);if(h)return h;break;case"gemini":const y=null!==(c=(0,i.DE)(e))&&void 0!==c?c:(0,i.Sy)(e);if(y)return y;break;case"anthropic":const _=null!==(d=(0,i.KF)(e))&&void 0!==d?d:(0,i.pL)(e);if(_)return _;break;case"openai-agent":const N=null!==(f=(0,i.xW)(e))&&void 0!==f?f:(0,i.m$)(e);if(N)return N;break;case"autogen":const E=null!==(m=(0,i.nW)(e))&&void 0!==m?m:(0,i.u6)(e);if(E)return E;break;case"bedrock":const M=null!==(p=(0,i.Yv)(e))&&void 0!==p?p:(0,i.f1)(e);if(M)return M;break;default:const A=null!==(v=(0,i.a8)(e))&&void 0!==v?v:(0,i.bS)(e);if(A)return A}return null}catch(g){return null}},P=e=>{var t;let n=null===(t=e.function)||void 0===t?void 0:t.arguments;try{n=JSON.stringify(JSON.parse(n),null,2)}catch(r){}return{id:e.id,function:{arguments:n,name:e.function.name}}},j=e=>{if((0,a.isNil)(e)||(0,a.isString)(e))return e;return e.map((e=>{var t;switch(e.type){case"text":case"input_text":case"output_text":return e.text;case"image_url":const n=null===e||void 0===e||null===(t=e.image_url)||void 0===t?void 0:t.url;return n?`![](${n})`:"[image]";case"input_audio":return"[audio]"}})).filter((e=>void 0!==e)).join("\n\n")},$=e=>{var t;return"reasoning"===e.type?null:{...e,content:j(e.content),tool_calls:null===(t=e.tool_calls)||void 0===t?void 0:t.map(P)}},q=e=>{if((0,a.isNil)(e))return"content";if(e.chatMessages)return"chat";return!(0,a.isNil)(e.inputs)||!(0,a.isNil)(e.outputs)?"content":"attributes"}},94664:function(e,t,n){n.d(t,{Dy:function(){return a},UG:function(){return r},VZ:function(){return s},cC:function(){return o}});let r=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.FUNCTION="FUNCTION",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.MEMORY="MEMORY",e.UNKNOWN="UNKNOWN",e}({}),a=function(e){return e.MODELS="models",e.DOCUMENT="document",e.CONNECT="connect",e.SEARCH="search",e.SORT="sort",e.UNKNOWN="unknown",e.FUNCTION="function",e.CODE="code",e.NUMBERS="numbers",e.WRENCH="wrench",e.AGENT="agent",e.CHAIN="chain",e.USER="user",e.SYSTEM="system",e.SAVE="save",e}({}),s=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.MEMORY="MEMORY",e.UNKNOWN="UNKNOWN",e}({}),o=function(e){return e.JSON="json",e.TEXT="text",e.MARKDOWN="markdown",e.PYTHON="python",e}({})}}]);