"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[8781],{668:function(e,t,s){s.r(t),s.d(t,{CompareModelVersionsPage:function(){return J},CompareModelVersionsPageImpl:function(){return K},default:function(){return G}});var a=s(46709),n=s(98022),r=s.n(n),o=s(56530),i=s(5690),l=s(43233),d=s(99213),c=s(74264),u=s(68248),h=s(91105),p=s(76118),m=s(40724),g=s(84173),f=s(74060),b=s(27757),N=s(40072),Y=(s(33779),s(91409)),I=s(67340),v=s(11057),w=s(60284),A=s(76400),M=s(37457),y=s(16389),R=s(95856),k=s(27206),x=s(61349),T=s(10536),S=s(73408);const{TabPane:q}=f.LegacyTabs;function L(e){const{theme:t}=(0,b.u)();return(0,S.Y)("div",{css:(0,u.AH)({textAlign:"center",color:t.colors.textSecondary},""),...e})}function C(e){const{theme:t}=(0,b.u)();return(0,S.Y)("table",{className:"mlflow-compare-table table",css:(0,u.AH)({"th.main-table-header":{backgroundColor:t.colors.white,padding:0},"td.highlight-data":{backgroundColor:t.colors.backgroundValidationWarning}},""),...e})}function D(e){const{theme:t}=(0,b.u)();return(0,S.Y)("button",{css:(0,u.AH)({textAlign:"left",display:"flex",alignItems:"center",border:"none",backgroundColor:t.colors.white,paddingLeft:0,cursor:"pointer"},""),...e})}class V extends a.Component{constructor(...e){super(...e),this.state={inputActive:!0,outputActive:!0,paramsToggle:!0,paramsActive:!0,schemaToggle:!0,compareByColumnNameToggle:!1,schemaActive:!0,metricToggle:!0,metricActive:!0},this.icons={plusIcon:(0,S.Y)("i",{className:"fa fa-plus-square-o"}),minusIcon:(0,S.Y)("i",{className:"fa fa-minus-square-o"}),downIcon:(0,S.Y)("i",{className:"fa fa-caret-down"}),rightIcon:(0,S.Y)("i",{className:"fa fa-caret-right"}),chartIcon:(0,S.Y)("i",{className:"fa fa-line-chart padding-left-text"})},this.onToggleClick=e=>{this.setState((t=>({[e]:!t[e]})))}}render(){const{inputsListByIndex:e,inputsListByName:t,modelName:s,outputsListByIndex:a,outputsListByName:n,runInfos:r,runUuids:o,runDisplayNames:i,paramLists:l,metricLists:d}=this.props,c=(0,S.Y)(m.A,{id:"6kSKRk",defaultMessage:"Comparing {numVersions} Versions",values:{numVersions:this.props.runInfos.length}}),p=[(0,S.Y)(h.N_,{to:k.fM.modelListPageRoute,children:(0,S.Y)(m.A,{id:"U82iv6",defaultMessage:"Registered Models"})}),(0,S.Y)(h.N_,{to:k.fM.getModelPageRoute(s),children:s})];return(0,S.FD)("div",{className:"CompareModelVersionsView",css:(0,u.AH)({...H.compareModelVersionsView,...H.wrapper(r.length)},""),children:[(0,S.Y)(T.z,{title:c,breadcrumbs:p}),(0,S.Y)("div",{className:"mlflow-responsive-table-container",children:(0,S.FD)(C,{children:[this.renderTableHeader(),this.renderModelVersionInfo(),this.renderSectionHeader("paramsActive","paramsToggle",(0,S.Y)(m.A,{id:"bSx/er",defaultMessage:"Parameters"})),this.renderParams(),this.renderSectionHeader("schemaActive","schemaToggle",(0,S.Y)(m.A,{id:"cK6riy",defaultMessage:"Schema"}),!1,(0,S.Y)(f.Switch,{className:"toggle-switch",style:{marginLeft:"auto"},onChange:()=>this.onToggleClick("compareByColumnNameToggle")}),(0,S.Y)("div",{className:"padding-left-text padding-right-text",children:(0,S.Y)("span",{children:(0,S.Y)(m.A,{id:"sXqvoN",defaultMessage:"Ignore column ordering"})})})),this.renderSchemaSectionHeader("inputActive",(0,S.Y)(m.A,{id:"GJWVBA",defaultMessage:"Inputs"})),this.renderSchema("inputActive",(0,S.Y)(m.A,{id:"ThrXMh",defaultMessage:"Inputs"}),e,t),this.renderSchemaSectionHeader("outputActive",(0,S.Y)(m.A,{id:"aB6xFd",defaultMessage:"Outputs"})),this.renderSchema("outputActive",(0,S.Y)(m.A,{id:"bqn2bk",defaultMessage:"Outputs"}),a,n),this.renderSectionHeader("metricActive","metricToggle",(0,S.Y)(m.A,{id:"CpLnGS",defaultMessage:"Metrics"})),this.renderMetrics()]})}),(0,S.FD)(f.LegacyTabs,{children:[(0,S.Y)(q,{tab:(0,S.Y)(m.A,{id:"QuU1sl",defaultMessage:"Parallel Coordinates Plot"}),children:(0,S.Y)(R.Ay,{runUuids:o})},"parallel-coordinates-plot"),(0,S.Y)(q,{tab:(0,S.Y)(m.A,{id:"4NEPlV",defaultMessage:"Scatter Plot"}),children:(0,S.Y)(Y.J,{runUuids:o,runDisplayNames:i})},"scatter-plot"),(0,S.Y)(q,{tab:(0,S.Y)(m.A,{id:"iXb99e",defaultMessage:"Box Plot"}),children:(0,S.Y)(I.e,{runUuids:o,runInfos:r,paramLists:l,metricLists:d})},"box-plot"),(0,S.Y)(q,{tab:(0,S.Y)(m.A,{id:"dq8MJd",defaultMessage:"Contour Plot"}),children:(0,S.Y)(v.A,{runUuids:o,runDisplayNames:i})},"contour-plot")]})]})}renderTableHeader(){const{runInfos:e,runInfosValid:t}=this.props;return(0,S.Y)("thead",{children:(0,S.FD)("tr",{className:"table-row",children:[(0,S.Y)("th",{scope:"row",className:"row-header block-content",children:(0,S.Y)(m.A,{id:"bi26D5",defaultMessage:"Run ID:"})}),e.map(((e,s)=>{var a,n;return(0,S.Y)("th",{scope:"column",className:"data-value block-content",children:t[s]?(0,S.Y)(h.N_,{to:w.Ay.getRunPageRoute(null!==(a=e.experimentId)&&void 0!==a?a:"0",null!==(n=e.runUuid)&&void 0!==n?n:""),children:e.runUuid}):e.runUuid},e.runUuid)}))]})})}renderModelVersionInfo(){const{runInfos:e,runInfosValid:t,versionsToRuns:s,runNames:a,modelName:n}=this.props;return(0,S.FD)("tbody",{className:"scrollable-table",children:[(0,S.FD)("tr",{className:"table-row",children:[(0,S.Y)("th",{scope:"row",className:"data-value block-content",children:(0,S.Y)(m.A,{id:"xmPKKq",defaultMessage:"Model Version:"})}),Object.keys(s).map((e=>{const t=s[e];return(0,S.Y)("td",{className:"meta-info block-content",children:(0,S.Y)(h.N_,{to:k.fM.getModelVersionPageRoute(n,e),children:e})},t)}))]}),(0,S.FD)("tr",{className:"table-row",children:[(0,S.Y)("th",{scope:"row",className:"data-value block-content",children:(0,S.Y)(m.A,{id:"erqoIC",defaultMessage:"Run Name:"})}),a.map(((t,s)=>(0,S.Y)("td",{className:"meta-info block-content",children:(0,S.Y)("div",{className:"truncate-text single-line cell-content",children:t})},e[s].runUuid)))]}),(0,S.FD)("tr",{className:"table-row",children:[(0,S.Y)("th",{scope:"row",className:"data-value block-content",children:(0,S.Y)(m.A,{id:"GKiPV1",defaultMessage:"Start Time:"})}),e.map(((e,s)=>{const a=e.startTime&&t[s]?y.A.formatTimestamp(e.startTime,this.props.intl):"(unknown)";return(0,S.Y)("td",{className:"meta-info block-content",children:a},e.runUuid)}))]})]})}renderSectionHeader(e,t,s,a=!0,n=null,r=null){const{runInfos:o}=this.props,i=this.state[e],{downIcon:l,rightIcon:d}=this.icons;return(0,S.Y)("tbody",{children:(0,S.Y)("tr",{children:(0,S.Y)("th",{scope:"rowgroup",className:"block-content main-table-header",colSpan:o.length+1,children:(0,S.FD)("div",{className:"switch-button-container",children:[(0,S.FD)(D,{onClick:()=>this.onToggleClick(e),children:[i?l:d,(0,S.Y)("span",{className:"header",children:s})]}),n,r,(0,S.Y)(f.Switch,{defaultChecked:!0,className:"toggle-switch",style:a?{marginLeft:"auto"}:{},onChange:()=>this.onToggleClick(t)}),(0,S.Y)("div",{className:"padding-left-text",children:(0,S.Y)("span",{children:(0,S.Y)(m.A,{id:"H+4gFh",defaultMessage:"Show diff only"})})})]})})})})}renderParams(){return(0,S.Y)("tbody",{className:"scrollable-table",children:this.renderDataRows(this.props.paramLists,(0,S.Y)(m.A,{id:"EK5JxG",defaultMessage:"Parameters"}),this.state.paramsActive,this.state.paramsToggle)})}renderSchemaSectionHeader(e,t){const{runInfos:s}=this.props,{schemaActive:a}=this.state,n=this.state[e],{minusIcon:r,plusIcon:o}=this.icons;return(0,S.Y)("tbody",{children:(0,S.Y)("tr",{className:""+(a?"":"hidden-row"),children:(0,S.Y)("th",{scope:"rowgroup",className:"schema-table-header block-content",colSpan:s.length+1,children:(0,S.FD)("button",{className:"schema-collapse-button",onClick:()=>this.onToggleClick(e),children:[n?r:o,(0,S.Y)("strong",{style:{paddingLeft:4},children:t})]})})})})}renderSchema(e,t,s,a){const{schemaActive:n,compareByColumnNameToggle:r,schemaToggle:o}=this.state,i=this.state[e],l=n&&i,d=!r&&!(0,p.isEmpty)(s),c=r&&!(0,p.isEmpty)(a),u=e=>e,h=(0,S.Y)(m.A,{id:"5RWIet",defaultMessage:"Schema {sectionName}",values:{sectionName:t}});return(0,S.FD)("tbody",{className:"scrollable-table schema-scrollable-table",children:[this.renderDataRows(s,h,l&&d,o,((e,s)=>(0,S.FD)(S.FK,{children:[t," [",e,"]"]})),u),this.renderDataRows(a,h,l&&c,o,((e,t)=>e),u)]})}renderMetrics(){const{runInfos:e,metricLists:t}=this.props,{metricActive:s,metricToggle:a}=this.state,{chartIcon:n}=this.icons;return(0,S.Y)("tbody",{className:"scrollable-table",children:this.renderDataRows(t,(0,S.Y)(m.A,{id:"GDenB3",defaultMessage:"Metrics"}),s,a,((t,s)=>(0,S.FD)(h.N_,{to:w.Ay.getMetricPageRoute(e.map((e=>e.runUuid)).filter(((e,t)=>void 0!==s[t])),t,[e[0].experimentId]),target:"_blank",title:"Plot chart",children:[t,n]})),y.A.formatMetric)})}renderDataRows(e,t,s=!0,a=!1,n=(e,t)=>e,r=e=>isNaN(e)?`"${e}"`:e){const o=M.A.getKeys(e),i={};if(o.forEach((e=>i[e]=[])),e.forEach(((e,t)=>{o.forEach((e=>i[e].push(void 0))),e.forEach((e=>i[e.key][t]=e.value))})),(0,p.isEmpty)(o)||(0,p.isEmpty)(e))return(0,S.Y)("tr",{className:"table-row "+(s?"":"hidden-row"),children:(0,S.Y)("th",{scope:"row",className:"rowHeader block-content",children:(0,S.Y)(L,{children:(0,S.Y)(m.A,{id:"47QsAK",defaultMessage:"{fieldName} are empty",values:{fieldName:t}})})})});(0,p.every)(o,(e=>!isNaN(e)))?o.sort(((e,t)=>parseInt(e,10)-parseInt(t,10))):o.sort();let l=!0;const d=o.map((e=>{const t=i[e].length>1&&(0,p.uniq)(i[e]).length>1;return l=!t&&l,(0,S.FD)("tr",{className:"table-row "+(a&&!t||!s?"hidden-row":""),children:[(0,S.Y)("th",{scope:"row",className:"rowHeader block-content",children:n(e,i[e])}),i[e].map(((e,s)=>(0,S.Y)("td",{className:"data-value block-content "+(t?"highlight-data":""),children:(0,S.Y)("span",{className:"truncate-text single-line cell-content",children:void 0===e?"-":r(e)})},this.props.runInfos[s].runUuid)))]},e)}));return l&&a?(0,S.Y)("tr",{className:"table-row "+(s?"":"hidden-row"),children:(0,S.Y)("th",{scope:"row",className:"rowHeader block-content",children:(0,S.Y)(L,{children:(0,S.Y)(m.A,{id:"NJ1bYP",defaultMessage:"{fieldName} are identical",values:{fieldName:t}})})})}):d}}const F=e=>{const t={};return e.forEach(((e,s)=>{const a=e.name?e.name:"",n=e.type?e.type:"";t[s]={key:s,value:""!==a&&""!==n?`${a}: ${n}`:`${a}${n}`}})),t},P=e=>{const t={};return e.forEach((e=>{const s=e.name?e.name:"-",a=e.type?e.type:"-";t[s]={key:s,value:a}})),t},H={wrapper:e=>({".mlflow-compare-table":{minWidth:200*(e+1)}}),compareModelVersionsView:{"button:focus":{outline:"none",boxShadow:"none"},"td.block-content th.block-content":{whiteSpace:"nowrap",textOverflow:"ellipsis",tableLayout:"fixed",boxSizing:"content-box"},"th.schema-table-header":{height:28,padding:0},"tr.table-row":{display:"table",width:"100%",tableLayout:"fixed"},"tr.hidden-row":{display:"none"},"tbody.scrollable-table":{width:"100%",display:"block",border:"none",maxHeight:400,overflowY:"auto"},"tbody.schema-scrollable-table":{maxHeight:200},".switch-button-container":{display:"flex",paddingTop:16,paddingBottom:16},"button.schema-collapse-button":{textAlign:"left",display:"block",width:"100%",height:"100%",border:"none"},".collapse-button":{textAlign:"left",display:"flex",alignItems:"center",border:"none",backgroundColor:"white",paddingLeft:0},".cell-content":{maxWidth:"200px",minWidth:"100px"},".padding-left-text":{paddingLeft:8},".padding-right-text":{paddingRight:16},".toggle-switch":{marginTop:2},".header":{paddingLeft:8,fontSize:16}}},U=(0,o.Ng)(((e,t)=>{const s=[],a=[],n=[],r=[],o=[],i=[],l=[],{modelName:d,versionsToRuns:c}=t,u=[],h=[],p=[],m=[];for(const g in c)if(c&&g in c){const t=c[g],f=(0,N.K4)(t,e);f?(s.push(f),a.push(!0),n.push(Object.values((0,A.d0)(t,e))),r.push(Object.values((0,N.tI)(t,e))),o.push(y.A.getRunName(f)),i.push(y.A.getRunDisplayName(f,t)),l.push(t)):(t?s.push({runUuid:t}):s.push({runUuid:"None"}),a.push(!1),n.push([]),r.push([]),o.push("Invalid Run"));const b=(0,x.SE)(e,d,g);h.push(Object.values(F(b.inputs))),u.push(Object.values(P(b.inputs))),m.push(Object.values(F(b.outputs))),p.push(Object.values(P(b.outputs)))}return{runInfos:s,runInfosValid:a,metricLists:n,paramLists:r,runNames:o,runDisplayNames:i,runUuids:l,modelName:d,inputsListByName:u,inputsListByIndex:h,outputsListByName:p,outputsListByIndex:m}}))((0,g.Ay)(V));var E=s(54401),B=s(2560),O=s(55570),_=s(91113);class K extends a.Component{constructor(...e){super(...e),this.registeredModelRequestId=(0,l.yk)(),this.versionRequestId=(0,l.yk)(),this.runRequestId=(0,l.yk)(),this.getMlModelFileRequestId=(0,l.yk)(),this.state={requestIds:[this.registeredModelRequestId,this.runRequestId,this.versionRequestId,this.getMlModelFileRequestId],requestIdsWith404ErrorsToIgnore:[this.runRequestId,this.getMlModelFileRequestId]}}removeRunRequestId(){this.setState((e=>({requestIds:(0,p.without)(e.requestIds,this.runRequestId)})))}componentDidMount(){this.props.getRegisteredModelApi(this.props.modelName,this.registeredModelRequestId);for(const e in this.props.versionsToRuns)if({}.hasOwnProperty.call(this.props.versionsToRuns,e)){const t=this.props.versionsToRuns[e];t?this.props.getRunApi(t,this.runRequestId).catch((()=>{this.removeRunRequestId()})):this.removeRunRequestId();const{modelName:s}=this.props;this.props.getModelVersionApi(s,e,this.versionRequestId),this.props.getModelVersionArtifactApi(s,e).then((t=>this.props.parseMlModelFile(s,e,t.value,this.getMlModelFileRequestId))).catch((()=>{this.setState((e=>({requestIds:(0,p.without)(e.requestIds,this.getMlModelFileRequestId)})))}))}}render(){return(0,S.Y)(E.L,{children:(0,S.Y)(c.Ay,{requestIds:this.state.requestIds,requestIdsWith404sToIgnore:this.state.requestIdsWith404ErrorsToIgnore,children:(0,S.Y)(U,{modelName:this.props.modelName,versionsToRuns:this.props.versionsToRuns})})})}}const W={getRunApi:i.aO,getRegisteredModelApi:d.SY,getModelVersionApi:d.s5,getModelVersionArtifactApi:d.ax,parseMlModelFile:d.qI},j=(0,B.h)((0,o.Ng)(((e,t)=>{const{location:s}=t,a=r().parse(s.search);return{modelName:decodeURIComponent(JSON.parse(a["?name"])),versionsToRuns:JSON.parse(a.runs)}}),W)(K)),J=(0,O.X)(_.A.mlflowServices.MODEL_REGISTRY,j);var G=J}}]);